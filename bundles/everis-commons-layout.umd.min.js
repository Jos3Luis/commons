!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("everiscore"),require("rxjs"),require("@angular/core")):"function"==typeof define&&define.amd?define("everiscommons/layout",["exports","@angular/common","everiscore","rxjs","@angular/core"],e):e((t.everis=t.everis||{},t.everis.commons=t.everis.commons||{},t.everis.commons.layout={}),t.ng.common,t["everiscore"],t.rxjs,t.ng.core)}(this,function(t,o,e,n,r){"use strict";function i(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,r,i=o.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)s.push(n.value)}catch(u){r={error:u}}finally{try{n&&!n.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return s}function s(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}var u=new r.InjectionToken("container"),a=function(){function t(){}return t.encryptStorage=function(t){return btoa(t).split("").reverse().join("")},t.unencryptStorage=function(t){return atob(t.split("").reverse().join(""))},t}(),c=function(){function t(t,e){this.layouts=t,this.sessionStorage=e,this.state=new n.Subject,this.$state=this.state.asObservable()}return t.prototype.getActive=function(){var t,e=this.sessionStorage.get("layout")||null;return 0<(t=null===e?this.layouts.filter(function(t){return!0===t["default"]}):this.layouts.filter(function(t){return t.name.toString().toLowerCase()===a.unencryptStorage(e).toString().toLowerCase()})).length&&t[0]},t.prototype.getItems=function(){return this.layouts},t.prototype.watch=function(){return this.$state},t.prototype.changeLayout=function(e){var t=this.layouts.filter(function(t){return t.name.toLowerCase()===e.toLowerCase()});if(!(0<t.length))throw new Error("El layout "+e+", no existe");this.sessionStorage.set("layout",a.encryptStorage(t[0].name)),this.state.next(t[0])},t}(),l=function C(t){this.header=t,this.name=this.header.name||null,this.logo=this.header.logo||null},f=function(){function t(t,e){this.menu=t,this.sessionStorage=e}return t.prototype.addItems=function(t){this.menu=s(this.menu,t),this.sessionStorage.set("menu",this.menu)},Object.defineProperty(t.prototype,"items",{get:function(){return(this.sessionStorage.get("menu")||null)&&(this.menu=this.sessionStorage.get("menu")||""),this.menu},enumerable:!0,configurable:!0}),t}(),p=function(){function t(t,e){this.config=t,this.sessionStorage=e,this._company=new l(this.config.company||{}),this._menu=new f(this.config.menu||[],this.sessionStorage),this._layout=new c(this.config.layouts,this.sessionStorage)}return Object.defineProperty(t.prototype,"company",{get:function(){return this._company},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menu",{get:function(){return this._menu},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0}),t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:r.Inject,args:[u]}]},{type:e.CoreBrowserStorage}]},t}(),y=function(){function t(t){this.viewContainerRef=t}return t.decorators=[{type:r.Directive,args:[{selector:"[eve-layout-ad-host]"}]}],t.ctorParameters=function(){return[{type:r.ViewContainerRef}]},t}(),g=function(){function t(t,e,o){this.componentFactoryResolver=t,this.cdr=e,this.lyCtrl=o}return t.prototype.ngAfterViewInit=function(){this.loadComponent(),this.cdr.detectChanges()},t.prototype.ngOnInit=function(){var t=this;this.lyCtrl.layout.watch().subscribe(function(){t.loadComponent()})},t.prototype.loadComponent=function(){var t=this.lyCtrl.layout.getActive();if(!1===t)throw new Error("No se encontro layouts para cargar por defecto, \n revise la configuracion en su modulo principal");var e=this.componentFactoryResolver.resolveComponentFactory(t.component),o=this.adHost.viewContainerRef;o.clear(),o.createComponent(e)},t.decorators=[{type:r.Component,args:[{selector:"eve-layout",template:"\n    <ng-template eve-layout-ad-host></ng-template>\n  "}]}],t.ctorParameters=function(){return[{type:r.ComponentFactoryResolver},{type:r.ChangeDetectorRef},{type:p}]},t.propDecorators={adHost:[{type:r.ViewChild,args:[y]}]},t}(),h=function(){function t(){}return t.prototype.singOut=function(){throw new Error("Debe proveer un objeto SingOut en la configuracion de Layout")},t.decorators=[{type:r.Injectable}],t}();function m(){return e.storage("session")}function d(t){return new p(t,m())}var v=[g,y],b=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:u,useValue:t},{provide:h,useClass:t.singOutAction||h},{provide:p,useFactory:d,deps:[u]},{multi:!0,provide:r.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:t.layouts}]}},e.decorators=[{type:r.NgModule,args:[{imports:[o.CommonModule],declarations:s(v),exports:s(v)}]}],e}();t._sessionStorage=m,t._buildLayoutCtrl=d,t._buildProviderSingOut=function w(t){return console.log(t.singOutAction&&null!==t.singOutAction,t.singOutAction),t.singOutAction&&null!==t.singOutAction?t.singOutAction:{}},t.LayoutController=p,t.CompanyLayout=l,t.MenuLayout=f,t.Layout=c,t.EveLayouManager=b,t.EveLayoutComponent=g,t.SingOut=h,t.ɵc=y,t.ɵb=u,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=everis-commons-layout.umd.min.js.map